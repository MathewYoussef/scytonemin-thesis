# UPLC_DAD_Scytonemin_Concentrations Resource Map

**Source base path:** `/Users/mathewyoussef/Desktop/UPLC_DAD_Scytonemin_Concentrations`

This document inventories the assets we should ingest into `scytonemin-thesis/` to rebuild the chromatogram/DAD and reflectance pipelines programmatically. Use it as the checklist when copying files.

---

## 1. `Initial_Calibration/` — UPLC/DAD Pipeline

### 1.1 Primary Data Tables (top-level CSV/JSON/YAML)
- `chromatogram_derived_concentrations.csv` — Chromatogram peak integrations per sample.
- `DAD_derived_concentrations.csv` / `DAD_derived_concentrations_corrected.csv` — Raw vs corrected DAD predictions.
- `treatments_concentration_raw.csv` / `treatments_corrected_amounts.csv` — Treatment-level concentration aggregates.
- `sample_id_truth.csv` — Mapping of sample IDs to treatment + UV schedule.
- `diode_array_auc.csv` — Band-specific absorbance integrals used as model features.
- `scytonemin_spectra_tidy.csv` — Preprocessed spectral tidy table for downstream analyses.
- `total_vs_parts_consistency.csv`, `total_vs_parts_model.json` — Consistency diagnostics + model metadata.
- Calibration bundles: `calibration_total.json`, `calibration_oxidized.json`, `calibration_reduced.json`, plus fits `standards_fitted_*.csv`.
- Workflow configs: `analysis_config.yaml`, `analysis_config_no_blank.yaml`.

### 1.2 Automation Scripts (`Initial_Calibration/Scripts/`)
| Script | Purpose |
| --- | --- |
| `run_stage_a.py` | Stage-A pipeline: ingest chromatograms, compute AUC features. |
| `run_stage_bc.py` | Stage-B/C pipeline: apply calibrations, generate corrected concentrations. |
| `compute_dad_auc.py`, `extract_dad_features.py` | Feature extraction from raw DAD spectra. |
| `fit_dad_calibration.py`, `compare_dad_calibrations.py` | Calibration fitting and comparison utilities. |
| `predict_dad_concentrations.py`, `normalize_dad_predictions.py` | Apply calibration and normalize by biomass. |
| `analyze_dad_features.py`, `dad_feature_dose_correlations.py` | Exploratory feature analysis. |
| Plotting utilities (`plot_*`, `generate_plots_for_paper.py`) | Recreate figures placed under `scaffold/initial_calibration/figures`. |
| Support scripts (`sample_ID_truth.py`, `list_truth_dose_combos.py`, `dose_effect_stats.py`, `summarize_stats_for_paper.py`, etc.) | Derive summary tables and stats.

_Note:_ `control_normalization_utils.py` is imported by several scripts; copy as well.

### 1.3 Raw & Intermediate Inputs
- `DAD_RAW_FILES/`
  - `scytonemin_chromatogram_areas/` (`raw_total_scytonemin.csv`, `raw_oxidized_scytonemin.csv`, `raw_reduced_scytonemin.csv`).
  - Instrument exports (`*.txt`, `*.xls`), randomization tables, standard concentration tables.
- `Compiled_DAD_DATA/` — staging area for processed DAD outputs (empty placeholder in this snapshot but keep structure).
- `Diode_Array_AUC/`, `Diode_Array_AUC_no_blank/`, `DAD_to_Concentration_AUC/` — intermediate dump directories referenced by scripts.
- `_concentrations_vs_dose_with_robust_mean/`, `mean_concentration_to_dose_4/` — notebooks & CSVs for robust averaging workflows.

### 1.4 Analysis / Visualization Assets
- `plots_for_paper/`, `Chromatogram_Calibration_Plots/`, `Chromatogram_derived_concentration_patterns_plots/`, `Reflectance_to_Concentration_Plots/` — figure directories to backfill `scaffold/initial_calibration/figures`.
- `stats_for_paper/` (subdirs include archived plots + robust concentration results).
- `Exploring_control_normalized/` — control-normalization experiments broken into multiple strategies (z-score, ratio, percent change, etc.).

### 1.5 Environment
- `venv/` — local virtual environment (do **not** copy; use requirements instead).

### 1.6 Recommended Destinations
| Destination (scytonemin-thesis) | Source | Notes |
| --- | --- | --- |
| `data/raw/initial_calibration/` | `Initial_Calibration/DAD_RAW_FILES/`, `Compiled_DAD_DATA/`, `Diode_Array_AUC*/`, `DAD_to_Concentration_AUC/` | Preserve raw & intermediate assets. |
| `data/reference/initial_calibration/` | Calibration JSON/CSV, configs, randomization tables | Inputs required for deterministic re-runs. |
| `src/chromatography/` | Scripts from `Initial_Calibration/Scripts/` (rename into modules) | Convert into importable modules + CLI wrappers. |
| `notebooks/initial_calibration/` | Selected exploratory notebooks under `_concentrations_vs_dose_with_robust_mean/`, `Exploring_control_normalized/` | Optional if needed for documentation. |
| `scaffold/initial_calibration/{figures,tables}` | Plots + summary tables generated by the pipeline | Copy only curated outputs; regenerate in pipeline. |

---

## 2. `Reflectance/` — Reflectance Pipeline

### 2.1 Python Package (`Reflectance/reflectance/`)
Core modules to migrate into `src/reflectance/`:
- `build_canonical_dataset.py`, `aggregate_reflectance.py`, `aggregate_reflectance_treatment.py`, `aggregate_dad_treatment.py` — construct canonical datasets and aggregate by dose/treatment.
- `merge_reflectance_with_concentration.py`, `chrom_vs_dad_analysis.py`, `treatment_level_comparison.py` — joins and comparative analyses against DAD outputs.
- `compute_precision_weighted_concentrations.py`, `dose_metadata.py`, `ensure_physical_dose_columns.py` — metadata prep + statistical weighting.
- `tests/verify_canonical_dataset.py` — regression test to port into `tests/`.

### 2.2 Canonical & Derived Data
- `reflectance/canonical_dataset/` — authoritative CSV/JSON exports (`dose_summary.csv`, `precision_weighted_concentrations.csv`, manifest, etc.).
- `reflectance/chrom_vs_dad_outputs/` — combined stats + PNG figures.
- `Combined_Scytonemin_Concentrations.csv`, `reflectance_concentration_crosswalk.csv`, `crosswalk_missing_concentration_ids.csv` — mapping tables for cross-block joins.
- `denoised_full_run_staging/` (two locations: top-level and inside package) — denoised spectra by treatment; ensure we keep the canonical copy used in scripts.
- `from_dose_concentration_chromo_dad_work_upstream/` — upstream staging inputs including `downstream_reflectance_hybrid/` and per-treatment denoised runs.

### 2.3 Projects & Supporting Material
- `imas_pipeline/` — importable utilities shared across IMAS demos; pull modules actually used by reflectance scripts.
- `projects/ga_smoother/` — genetic algorithm smoothing experiments (decide if required for reproducibility).
- `sigma_justification/phase*/` — documentation and interim calculations for smoothing parameters.
- `documentation/` — supplementary markdown and notebooks.
- `scripts/run_catalogue.sh`, `scripts/run_demo.sh` — shell entry points; adapt into Makefile/CLI tasks.
- `environment.yml` — dependency list (merge into root `env/`).

### 2.4 Recommended Destinations
| Destination (scytonemin-thesis) | Source | Notes |
| --- | --- | --- |
| `src/reflectance/` | Modules from `Reflectance/reflectance/*.py` | Convert to package modules with shared logging/config. |
| `data/raw/reflectance/` | `denoised_full_run_staging/`, `from_dose_concentration_chromo_dad_work_upstream/` | Raw spectra and upstream drops. |
| `data/reference/reflectance/` | Canonical dataset CSV/JSON, crosswalk tables | Needed for regression tests and documentation. |
| `scaffold/reflectance/{figures,tables}` | `chrom_vs_dad_outputs/`, canonical figures | Copy curated outputs or regenerate via pipeline. |
| `docs/reflectance/` | Relevant markdown from `documentation/`, `sigma_justification/` | Integrate into MkDocs site. |

---

## 3. Integration Checklist

| Task | Files / Folders | Follow-up |
| --- | --- | --- |
| Copy raw instrument exports | `Initial_Calibration/DAD_RAW_FILES/` | Ensure `.DS_Store` removed; add README with acquisition notes. |
| Port calibration scripts to `src/chromatography` | `Initial_Calibration/Scripts/*.py` | Refactor into modules + CLI wrappers consumed by `Makefile`. |
| Bring canonical tables & manifests | `reflectance/canonical_dataset/`, `Initial_Calibration/*.csv` | Add provenance docs under `data/**/`. |
| Align processed figures | `Chromatogram_Calibration_Plots/`, `Reflectance/reflectance/chrom_vs_dad_outputs/` | Re-export via new pipelines to populate `scaffold/**/figures`. |
| Consolidate environment specs | `Reflectance/environment.yml`, `Initial_Calibration/venv` (for reference only) | Merge dependencies into root `env/` and remove local venvs. |
| Document exploratory notebooks | `Exploring_control_normalized/`, `sigma_justification/` | Decide which become published notebooks vs archive. |
| Set up tests | `Reflectance/reflectance/tests/verify_canonical_dataset.py`, Stage scripts | Port into `tests/` with pytest markers. |

**Manual copy note:** When moving assets, maintain relative directory structures where practical (e.g., keep treatment folders under `denoised_full_run_staging/`). Drop temporary caches (`tmp_matplotlib/`, `venv/`, `.mplconfig`, etc.) to keep the repo clean.


---

## 3. `Act_of_God_Mamba_Results/` — Mamba SSM Artifacts

**Note:** Reviewers cannot rerun the full Mamba training, so we must carry the trained checkpoints, manifests, validation panel, and QA outputs as shipped assets, while still pulling in scripts/configs so the evaluation tools remain reproducible.

### 3.1 Data & Manifests
- `data/spectra_for_fold/` — Denoised training spectra per treatment (keep structure).
- `data/validation_panel.csv` + `validation_panel_summary.md` — Fixed hold-out panel (include hash note).
- `data/train_manifest_summary.md`, `training_group_counts.md`, `cv_fold02_train_summary.md` — coverage audits.
- `data/metadata/` — dose feature tables (`dose_features.csv`, `dose_sampling_weights.csv`, `dose_stats.json`) with README.
- `manifests/fold_*/train|val|test_manifest.csv` — per-fold manifest snapshots.
- `data/denoised_full_run_staging/`, `data/_staging/` — intermediate spectra dumps referenced by scripts.

### 3.2 Configs & Source Code
- `configs/folds.json` — canonical fold configuration.
- `scripts/*.py` — CLI tools: `generate_fold_manifests.py`, `run_cross_validation.py`, `run_denoise_from_manifest.py`, `export_*`, `evaluate_validation_panel.py`, `downstream_proxy_eval.py`.
- `src/` package — training/inference modules (`train.py`, `infer.py`, `datasets.py`, `models/mamba_uv.py`, `losses.py`, `metrics.py`, `utils/`).
- `thesis_notes/` & `for_the_auditors_understanding/` — narrative context; decide how much to port into docs.

### 3.3 Checkpoints & Logs
- `checkpoints/prod/Track_H_fold_02/mamba_tiny_uv_best.pt` — warm-start source.
- `checkpoints/god_run/mamba_tiny_uv_best.pt` + related runs (capture best + failed attempt directory for audit).
- `logs/god_run/` — training logs + metrics CSV; include failed run logs for transparency.
- `artifacts/roi_local_plots_full/` — ROI inspection figures.

### 3.4 Final Analytics & Figures
- `final_analytics/panel_eval/` — panel readiness outputs (`README_audit.md`, `*_per_spectrum_metrics.csv`, `panel_eval_summary.json`).
- `final_analytics/denoised_full_run.csv` — full-run inference export.
- `plot_series/plot_series_alpha|beta/outputs` — generated comparison plots (curate into `scaffold/mamba_ssm/figures`).

### 3.5 Recommended Destinations
| Destination (scytonemin-thesis) | Source | Notes |
| --- | --- | --- |
| `data/raw/mamba_ssm/` | `data/spectra_for_fold/`, `data/_staging/`, `data/denoised_full_run_staging/` | Preserve spectra used for training/eval. |
| `data/reference/mamba_ssm/` | `data/metadata/`, manifests, panel CSV, coverage summaries | Needed for verification scripts. |
| `models/mamba_ssm/` | `checkpoints/**/mamba_tiny_uv_best.pt` | Ship trained model weights. |
| `src/mamba_ssm/` | `src/` modules + `scripts/*.py` (refactored) | Provide inference/evaluation tooling. |
| `scaffold/mamba_ssm/{figures,tables}` | `final_analytics/`, `plot_series/*/outputs`, ROI plots | Curate final plots/tables for docs. |
| `ops/output/data/mamba_checks/` | Panel eval summaries, metric CSVs | Optional: centralize audit outputs. |

### 3.6 Cleanup Guidance
- Remove `.DS_Store`, `__pycache__/`, large intermediate logs not needed for audit.
- For failed runs (`checkpoints/god_run_failed_*`, `logs/god_run_failed_*`), keep high-level summary but consider archiving bulky raw logs elsewhere if size is prohibitive; document decision in ops log.
- Ensure any proprietary directories (e.g., `plot_series_beta/outputs` if oversized) are curated before committing.

---

## 4. Regeneration Notes (Raw → Outputs)

- **Initial Calibration:** Execute refactored Stage A/B scripts via Makefile (`make reproduce`) to rebuild DAD concentration tables and associated plots.
- **Reflectance:** Run canonical dataset builder and aggregation scripts after denoised spectra are copied; outputs populate `data-processed/reflectance` and `scaffold/reflectance/figures`.
- **Mamba SSM:** Training is not re-run; instead ship checkpoints, manifests, and evaluation scripts so auditors can reproduce validation metrics and downstream proxy checks using the provided weights and spectra.

Document each migration step in `ops/logs/` once files are copied so the audit trail stays intact.
